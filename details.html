<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grand Theft Auto V - Game Details</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="details.css">
</head>
<body>
    <main class="main">
        <div id="game-details">
            <!-- Game details will be populated by JavaScript -->
        </div>
    </main>

    <script src="script.js"></script>
    <script>

        // Get game ID from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const gameId = urlParams.get('id');

        if (gameId) {
            
            getGameDetails(gameId).then(game => {
                if (game) {
                    renderGameDetails(game);
                } else {
                    document.getElementById('game-details').innerHTML = '<p>Game details not found.</p>';
                }
            });
        } else {
            document.getElementById('game-details').innerHTML = '<p>No game ID provided in URL.</p>';
        }

        function renderGameDetails(game) {
            const gameDetailsDiv = document.getElementById('game-details');
            document.title=game.name + " - Game Details";
        
            const heroSection = `
                <div class="hero-section">
                    <div class="hero-background">
                        <img src="${game.background_image}"alt="${game.name} Background" class="hero-image">
                        <div class="hero-overlay"></div>
                    </div>
                    <div class="hero-content container">
                        <div class="game-header">
                            <h1 class="game-title">${game.name}</h1>
                            <div class="game-meta">
                                <span class="release-date">${new Date(game.released).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
                                ${game.esrb_rating ? `<span class="rating-badge mature">${game.esrb_rating.name.charAt(0)}</span>` : ''}
                            </div>
                        </div>
                        
                        <div class="rating-section">
                            <div class="metacritic-score">
                                <span class="score-number">${game.metacritic}</span>
                                <span class="score-label">Metacritic</span>
                            </div>
                            <div class="user-rating">
                                <div class="stars">
                                    ${generateStars(game.rating)}
                                </div>
                                <span class="rating-text">${game.rating}/5 (${game.reviews_count.toLocaleString()} reviews)</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Create content section
            const contentSection = `
                <div class="content-section container">
                    <div class="main-content">
                        <section class="description-section">
                            <h2>About This Game</h2>
                            ${game.description.split('\n').map(paragraph => `<p class="description">${paragraph}</p>`).join('')}
                        </section>

                        <section class="platforms-section">
                            <h2>Available Platforms</h2>
                            <div class="platforms-grid">
                                ${game.platforms.map(p => `
                                    <div class="platform-card">
                                        <div class="platform-icon">${getPlatformIcon(p.platform.name)}</div>
                                        <span class="platform-name">${p.platform.name}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </section>

                        <section class="tags-section">
                            <h2>Game Tags</h2>
                            <div class="tags-container">
                                ${game.tags.map(tag => `<span class="tag">${tag.name}</span>`).join('')}
                            </div>
                        </section>
                    </div>

                    <aside class="sidebar">
                        <div class="info-card">
                            <h3>Game Statistics</h3>
                            <div class="stat-item">
                                <span class="stat-label">Average Playtime</span>
                                <span class="stat-value">${game.playtime} hours</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Total Players</span>
                                <span class="stat-value">${game.added.toLocaleString()}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Screenshots</span>
                                <span class="stat-value">${game.screenshots_count}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Achievements</span>
                                <span class="stat-value">${game.achievements_count}</span>
                            </div>
                        </div>

                        <div class="info-card">
                            <h3>Player Status</h3>
                            <div class="status-bar">
                                <div class="status-item owned">
                                    <span class="status-label">Owned</span>
                                    <span class="status-count">${game.added_by_status.owned.toLocaleString()}</span>
                                </div>
                                <div class="status-item beaten">
                                    <span class="status-label">Beaten</span>
                                    <span class="status-count">${game.added_by_status.beaten.toLocaleString()}</span>
                                </div>
                                <div class="status-item playing">
                                    <span class="status-label">Playing</span>
                                    <span class="status-count">${game.added_by_status.playing.toLocaleString()}</span>
                                </div>
                                <div class="status-item toplay">
                                    <span class="status-label">To Play</span>
                                    <span class="status-count">${game.added_by_status.toplay.toLocaleString()}</span>
                                </div>
                            </div>
                        </div>

                        <div class="info-card">
                            <h3>Store Links</h3>
                            <div class="store-links">
                                ${console.log(game.stores) && game.stores.map(store => `
                                    <a href="#" class="store-link ${store.store.slug}">
                                        <span class="store-icon">${getStoreIcon(store.store.name)}</span>
                                        <span class="store-name">${store.store.name}</span>
                                    </a>
                                `).join('')}
                            </div>
                        </div>

                        <div class="info-card">
                            <h3>Developer & Publisher</h3>
                            <div class="dev-info">
                                <div class="dev-item">
                                    <span class="dev-label">Developer</span>
       <span class="dev-value">
  ${game.developers.map(dev => dev.name).join(', ')}
</span>
                                    </div>
                                <div class="dev-item">
                                    <span class="dev-label">Publisher</span>
                                    <span class="dev-value"> ${game.publishers.map(dev => dev.name).join(', ')}</span>
                                </div>
                                <div class="dev-item">
                                    <span class="dev-label">Genre</span>
                                    <span class="dev-value">${game.genres.map(g => g.name).join(', ')}</span>
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            `;

            gameDetailsDiv.innerHTML = heroSection + contentSection;
        }

        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let stars = '';
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<span class="star filled">★</span>';
            }
            
            if (hasHalfStar) {
                stars += '<span class="star half">★</span>';
            }
            
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<span class="star">★</span>';
            }
            
            return stars;
        }

      function getPlatformIcon(platformName) {
    const icons = {
        'PC': '<i class="bi bi-pc-display"></i>',
        'PlayStation 5': '<i class="bi bi-controller"></i>',
        'PlayStation 4': '<i class="bi bi-controller"></i>',
        'PlayStation 3': '<i class="bi bi-controller"></i>',
        'Xbox Series S/X': '<i class="bi bi-xbox"></i>',
        'Xbox One': '<i class="bi bi-xbox"></i>',
        'Xbox 360': '<i class="bi bi-xbox"></i>'
    };
    return icons[platformName] || '<i class="bi bi-controller"></i>';
}


     function getStoreIcon(storeName) {
    const icons = {
        'Steam': '<i class="bi bi-steam"></i>',
        'Epic Games': '<i class="bi bi-controller"></i>',
        'PlayStation Store': '<i class="bi bi-playstation"></i>',
        'Xbox Store': '<i class="bi bi-xbox"></i>',
        'Microsoft Store': '<i class="bi bi-windows"></i>',
        'Apple App Store': '<i class="bi bi-apple"></i>',
        'GOG': '<i class="bi bi-capslock"></i>',  // No official icon, placeholder
        'Nintendo eShop': '<i class="bi bi-controller"></i>', // or bi-nintendo if you have custom icon
        'Google Play Store': '<i class="bi bi-google-play"></i>' // Not official in bootstrap, consider custom icon
    };
    return icons[storeName] || '<i class="bi bi-bag"></i>'; // default icon
}


    </script>
</body>
</html>